---
title: Написание упругих компонентов
date: '2019-03-16'
spoiler: Четыре принципа, что бы направить вас в нужном направлении.
---


Когда люди начинают изучать React, они часто спрашивают о стайлгайде. С одной стороны - это хорошая идея иметь последовательные правила по всему проекту, но с другой стороны, многие из этих правилпроизвольны и поэтому React не имеет сторого мнения на их счёт.

Вы можете использовать разные системы типиизации, предпочитать объявление функций (function declarations) или стрелочные функции, распологать ваши пропсы в алфавитном порядке или в любом другом порядке, который вам нравится. 

Эта гибкость позволяет интегрировать React в проекты с уже существующими соглашениями в нутри него. Но так же это порождает бесконечные споры.

Есть важные принципы проектирования, которым каждый компонент должен придерживаться. Но я не думаю, что стайлгайды хорошо охватывают эти принципы. Сначала мы поговорим о стайлгайдах и потом взглянем на принципы, которые действительно полезны.

---

## Не отвлекайтесь на воображаемые проблемы

Прежде чем мы поговорим о принципах разработки компонентов, я хочу сказать пару слов о стайлгайдах. Это не популярное мнение, но кто-то должен его озвучить!

В JavaScript сообществе, несколько строгих и упрямых стайлгайдов насаждаемых линтером. Моё личное наблюдение: линтеры склонны создавать больше сложностей, чем они того стоят. Я не смогу сощитать как много раз кто-то показывал мне абсолютно валидный код и говорил при этом: "React жалуется на это", но на самом деле причина была в конфиге их линтера! Это привод к трем проблемам.

* Люди привыкли видеть в линтерах не полезный инструмент, а черезмерно надоедливого надсмоторщика??? Поолезные замечания тонут среди советов??? о стиле кода. Как результат, люди не просматривают сообщения от линтера во время дебага и пропускают действительно полезные заметки. Дополнительно, люди которые меньше привыкли писать на JavaScript (например, дизайнеры) будут испытывать ещё больше трудностей при работы с кодом. 

* Люди не учаться **различать валидное и невалидное применение** конкретного паттерна. Например, есть популярное правило, которое запрещает вызов `setState` внутри `componentDidMount`. Но если бы этот паттер всегда был бы "плох", React по-просту не позволял его использовать. Есть случаи, когда такой паттер оправдан, например вам нужно измерить DOM элемент для размещения около него тултипа. Я видел как люди обходят это правило добавляя `setTimeout`, который абсолютно не учитывает вышесказанное.

* В итоге, люди принимают эту насаждённую линтерами установку и получают навязанное мнение о вещах которые **не несут существенной разницы** но легко сканируемы в коде. "Вы использовали декларировании функций, но в **нашем** проекты мы используем стрелочные функции". Когда бы я не испытывал сильное чувство связанное с навязыванием подобных правил, глубокий взгляд показывает, что я вложил некие эмоциональный усилия в это правило и изо всех сил стараюсь его отпустить??? Это заманивает меня в ловушку ложного чувства выполненного долга без действительного улучшения моего кода.

Говорю ли я, что нам нужно прекратить пользоваться линтерами? Вовсе нет!

**С хорошим конфигом, линтер отличная вещь для предотвращения багов.** Но если линтер будет сильно фокусируется на *стиле* он будет вас отвлекать.

---

## Наведи порядок в своём коде как Мари Кондо??

Вот что я предлагаю вам сделать в понедельник. Собиретесь всей командой на полтора часа, пройдитесь по всем включённым правилам линтера в конфиге вашего проекта и спросите себя: "Помогало ли это правило поймать баг?"* Если нет, *выключайте его.* (Вы так же можете начать с чистого листа с [`eslint-config-react-app`](https://www.npmjs.com/package/eslint-config-react-app) у этого конфига нет правил по стилям.)

Хотя бы ваша команда должна иметь процесс, который позволит ей удалять правила, которые вызывают разногласия. Не предполагайте, что все что вы или кто-то другой добавили в конфиг линтера год назад, является "лучшей практикой". Ставьте это под вопрос и ищите ответы. Не позволяйте кому-либо говорить, что вы не достаточно умны, что бы выбирать настройки для вашего линтера.